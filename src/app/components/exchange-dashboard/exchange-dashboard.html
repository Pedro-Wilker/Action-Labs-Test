<header class="app-header">
    <div class="logo">Action Labs</div>
</header>

<main class="app-main">

    <h1 class="app-title">BRL EXCHANGE RATE</h1>

    <div class="search-container">
        <input type="text" class="currency-input" placeholder="Enter the currency code" [(ngModel)]="currencyCode"
            (keyup.enter)="searchExchangeRate()" #currencyInput>
    </div>

    <button class="exchange-button" (click)="searchExchangeRate()" [disabled]="loading() || !currencyCode.trim()">
        EXCHANGE RESULT
    </button>

    <div class="result-container" *ngIf="currentRate() && !loading()">
        <div class="result-header">
            <div class="exchange-date">Exchange rate now {{ currentRate()?.lastUpdated | date:'dd/MM/yyyy - HH:mm' }}
            </div>
            <div class="currency-pair">{{ currentRate()?.fromSymbol }}/{{ currentRate()?.toSymbol }}</div>
        </div>

        <div class="exchange-value">R$ {{ currentRate()?.rate | number:'1.2-2' }}</div>

        <div class="divider"></div>

        <div class="history-section" (click)="toggleHistory()">
            <span>LAST 30 DAYS</span>
            <span class="toggle-icon">{{ showHistory() ? '−' : '+' }}</span>
        </div>
    </div>

    <div class="loading-container" *ngIf="loading()">
        <div class="loading-spinner"></div>
        <p>Loading exchange rate...</p>
    </div>

    <div class="error-container" *ngIf="error() && !loading()">
        <p>{{ error() }}</p>
        <button class="retry-button" (click)="searchExchangeRate()">Try Again</button>
    </div>

    <div class="history-container" *ngIf="showHistory() && historicalData().length > 0">
        <div class="history-card" *ngFor="let data of historicalData()">
            <div class="history-date">{{ data.date | date:'dd/MM/yyyy' }}</div>

            <div class="history-grid">
                <div class="grid-item">
                    <span class="label">OPEN</span>
                    <span class="value">R$ {{ data.open | number:'1.4-4' }}</span>
                </div>
                <div class="grid-item">
                    <span class="label">HIGH</span>
                    <span class="value">R$ {{ data.high | number:'1.4-4' }}</span>
                </div>
                <div class="grid-item">
                    <span class="label">CLOSE</span>
                    <span class="value">R$ {{ data.close | number:'1.4-4' }}</span>
                </div>
                <div class="grid-item">
                    <span class="label">LOW</span>
                    <span class="value">R$ {{ data.low | number:'1.4-4' }}</span>
                </div>
            </div>

            <div class="close-diff" [class.positive]="data.closeDiff > 0" [class.negative]="data.closeDiff < 0">
                <span class="diff-icon">{{ data.closeDiff > 0 ? '↑' : '↓' }}</span>
                CLOSE DIFF (%): {{ data.closeDiff > 0 ? '+' : '' }}{{ data.closeDiff | number:'1.2-2' }}%
            </div>
        </div>
    </div>
</main>

<footer class="app-footer">
    Copyright 2022 - Action Labs
</footer>